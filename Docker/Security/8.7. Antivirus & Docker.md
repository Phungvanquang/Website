# 8.7. Antivirus & Docker


### üîπ 1. ClamAV trong Docker.

**ClamAV** l√† ph·∫ßn m·ªÅm antivirus m√£ ngu·ªìn m·ªü, th∆∞·ªùng d√πng ƒë·ªÉ ph√°t hi·ªán malware trong file.

* **M·ª•c ti√™u**: qu√©t c√°c file ƒë∆∞·ª£c mount v√†o container, ho·∫∑c qu√©t tr·ª±c ti·∫øp filesystem c·ªßa container.
* **C√°ch d√πng trong Docker**:

  * T·∫°o container ClamAV ri√™ng bi·ªát (containerized AV).
  * Mount volume ch·ª©a d·ªØ li·ªáu (uploads, shared data) ƒë·ªÉ qu√©t.
  * C√≥ th·ªÉ t√≠ch h·ª£p v√†o CI/CD ƒë·ªÉ ki·ªÉm tra artifact tr∆∞·ªõc khi ƒë∆∞a l√™n production.

üëâ V√≠ d·ª• (ch·∫°y ClamAV trong Docker):

```bash
docker run -it --rm -v /path/to/scan:/scan clamav/clamav:latest clamscan -r /scan
```

ƒêi·ªÅu n√†y gi√∫p **ngƒÉn ch·∫∑n malware x√¢m nh·∫≠p t·ª´ d·ªØ li·ªáu t·∫£i l√™n** (file upload trong web app ch·∫≥ng h·∫°n).

### 2. Trivy ‚Äì Vulnerability & Misconfiguration Scanner.

**Trivy (Aqua Security ph√°t tri·ªÉn)** l√† c√¥ng c·ª• ph·ªï bi·∫øn ƒë·ªÉ:

* Qu√©t **image Docker** ƒë·ªÉ t√¨m l·ªó h·ªïng trong OS package v√† th∆∞ vi·ªán.
* Ki·ªÉm tra **misconfiguration** trong Dockerfile, Kubernetes manifest.
* Ph√°t hi·ªán **secret leak** (API keys, password hardcoded).

üëâ V√≠ d·ª• qu√©t m·ªôt image Docker:

```bash
trivy image nginx:1.21
```

Trivy s·∫Ω tr·∫£ k·∫øt qu·∫£ g·ªìm:

* **CVE-ID** (m√£ l·ªó h·ªïng),
* **m·ª©c ƒë·ªô nghi√™m tr·ªçng (LOW, MEDIUM, HIGH, CRITICAL)**,
* **package b·ªã ·∫£nh h∆∞·ªüng**.

### 3. Aqua Security (Commercial & Enterprise-grade).

**Aqua Security** l√† n·ªÅn t·∫£ng b·∫£o m·∫≠t container **cao c·∫•p h∆°n** (so v·ªõi ClamAV v√† Trivy):

* **Image scanning**: ph√°t hi·ªán malware, secret, config l·ªói.
* **Runtime Protection**: gi√°m s√°t h√†nh vi container ‚Üí ph√°t hi·ªán b·∫•t th∆∞·ªùng (process injection, file modification).
* **Policy Enforcement**: ki·ªÉm so√°t container ch·∫°y theo rule (v√≠ d·ª•: kh√¥ng cho ch·∫°y container ‚Äúprivileged‚Äù).
* **Integration**: d·ªÖ t√≠ch h·ª£p v√†o Kubernetes, CI/CD pipeline, Cloud registry.

‚ö° ƒêi·ªÉm m·∫°nh: kh√¥ng ch·ªâ scan khi build, m√† c√≤n **gi√°m s√°t container l√∫c runtime**, gi·ªëng nh∆∞ IDS/IPS trong m√¥i tr∆∞·ªùng container.

### 4. So s√°nh nhanh.

| C√¥ng c·ª•       | M·ª•c ti√™u ch√≠nh                  | Giai ƒëo·∫°n √°p d·ª•ng                    | ƒêi·ªÉm m·∫°nh                       |
| ------------- | ------------------------------- | ------------------------------------ | ------------------------------- |
| **ClamAV**    | Qu√©t malware trong file/data    | Runtime (d·ªØ li·ªáu upload, filesystem) | Ph√π h·ª£p ƒë·ªÉ ch·∫∑n file ƒë·ªôc h·∫°i    |
| **Trivy**     | Qu√©t l·ªó h·ªïng & misconfiguration | Build & Pre-deploy                   | Nhanh, d·ªÖ t√≠ch h·ª£p CI/CD        |
| **Aqua Sec.** | Qu√©t + Gi√°m s√°t + Policy        | Build & Runtime                      | Enterprise, full-stack security |

### 5. √ù nghƒ©a b·∫£o m·∫≠t.

* **ClamAV** ‚Üí l·ªõp b·∫£o v·ªá truy·ªÅn th·ªëng ch·ªëng **malware**.
* **Trivy** ‚Üí l·ªõp ph√°t hi·ªán **l·ªó h·ªïng & l·ªói c·∫•u h√¨nh** trong image.
* **Aqua Security** ‚Üí l·ªõp gi√°m s√°t **runtime + compliance**.



