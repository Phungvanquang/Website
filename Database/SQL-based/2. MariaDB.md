# MariaDB





* **MariaDB** là một fork của MySQL do cộng đồng và các cựu dev MySQL phát triển (bắt đầu từ khi Oracle mua Sun/ MySQL).
* Mục tiêu: tương thích ngược với MySQL nhưng bổ sung tính năng, engine và cải tiến hiệu năng.
* Được dùng rộng rãi để thay thế MySQL trong hosting, cloud và hệ thống doanh nghiệp — nhiều distro Linux cài MariaDB làm mặc định.

--> Vì tương thích cao nên hầu hết ứng dụng web (WordPress, Drupal, Magento, v.v.) có thể chạy trên MariaDB mà không hoặc ít phải chỉnh sửa.

# 1. Kiến trúc MariaDB

MariaDB có cấu trúc tương tự MySQL, tách rõ thành 2 tầng chính:

1. **SQL Layer** (giao tiếp & xử lý truy vấn):

   * Parser (phân tích SQL)
   * Optimizer (tối ưu plan)
   * Query cache / kết quả cache (tuỳ phiên bản/ cấu hình)

2. **Storage Engine Layer** (công cụ lưu trữ — có nhiều lựa chọn):

   * **InnoDB / XtraDB** – hỗ trợ transaction, khóa, foreign key (XtraDB từng là alternative cho InnoDB ở một số bản cũ).
   * **Aria** – engine do MariaDB phát triển (thay thế MyISAM cho các table tạm/ nội bộ).
   * **MyISAM**, **Memory**, **CSV** – engine truyền thống.
   * **ColumnStore** – cho analytic/ OLAP (columnar).
   * **Spider, CONNECT, S3, Cassandra engine** (và một số engine mở rộng khác) — giúp tích hợp phân tán hoặc lưu trữ chuyên dụng.

> MariaDB nổi bật ở việc hỗ trợ nhiều engine & extension hơn MySQL “nguyên bản”.

# 2. Database mặc định trong MariaDB.

* **`mysql`** → lưu user, quyền, plugin xác thực.
* **`information_schema`** → metadata (danh sách DB, bảng, cột, constraints).
* **`performance_schema`** → giám sát hiệu năng (tuỳ bật/tắt).
* **`sys`** → tập hợp view tiện dụng cho quản trị (nhiều hệ thống cài sẵn).

Lưu ý: tên cột chứa hash mật khẩu có thể khác theo phiên bản (ví dụ `Password`, `authentication_string`, hoặc sử dụng các plugin auth). Khi pentest, kiểm tra bảng `mysql.user` để biết cấu trúc.

Ví dụ pentest:

```sql
SHOW DATABASES;
SELECT user, host, password FROM mysql.user; -- column name có thể là `password` hoặc `authentication_string` tùy phiên bản
SELECT schema_name FROM information_schema.schemata;
```
# 3. Câu lệnh cơ bản.

### Liệt kê database:

```sql
SHOW DATABASES;
```

### Liệt kê bảng trong DB:

```sql
USE target_db;
SHOW TABLES;
```

### Liệt kê cột trong bảng:

```sql
SHOW COLUMNS FROM users;
-- hoặc
SELECT column_name FROM information_schema.columns WHERE table_name='users';
```

### Dump dữ liệu (ví dụ lấy user/pass):

```sql
SELECT username, password FROM users;
```

(Đúng như MySQL — cú pháp SQL gần như tương đương, nên hầu hết “cheat-sheet” MySQL áp dụng cho MariaDB.)

# 4. Ứng dụng MariaDB trong Website

* **LAMP / LEMP stack**: MariaDB thay MySQL trong nhiều bản Linux/hosting.
* **CMS & E-commerce**: WordPress, Drupal, Joomla, Magento, OpenCart… chạy tốt trên MariaDB.
* **Frameworks**: PHP frameworks (Laravel, CodeIgniter, Symfony) – thường tương thích; cũng dùng được với nhiều ngôn ngữ khác.
* **Cloud / Cluster**: MariaDB + Galera Cluster (synchronous multi-master) cho HA và scale viết nhiều.
* **Analytics**: ColumnStore / Columnar engine cho nhu cầu phân tích dữ liệu lớn.
# 5. Bảo mật & Lỗ hổng thường gặp

* **SQL Injection (SQLi)** → vẫn là rủi ro chính trên web dùng MariaDB (vì cùng kiểu SQL).
* **Weak/default password** → account root không đổi mật khẩu.
* **Authentication/plugin differences** → MariaDB hỗ trợ các plugin (ví dụ `unix_socket`) có thể cho phép login không cần mật khẩu trên socket — biết cấu hình plugin rất quan trọng khi pentest.
* **Privilege misconfiguration** → user web có quyền quá lớn (READ/WRITE trên các DB hệ thống).
* **Exposed service** → MariaDB bind ra `0.0.0.0` hoặc port 3306 mở công khai.
* **Engine-specific pitfalls** → ví dụ dùng Aria/MyISAM mà không có transaction có thể làm leak thông tin theo logic app.

# 5. danh sách câu lệnh.
- https://mariadb.com/docs/server/reference/sql-statements
- https://www.almabetter.com/bytes/cheat-sheet/mariadb

